<!DOCTYPE html>
<html lang="en">
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"/>
  <meta charset="UTF-8" />
  <title>Phasmo CS</title>
  <style>
    /*****************************************************
     1) DEMONIC BACKGROUND (Spinning Circle + Pentagram)
    *****************************************************/
    html, body {
      margin: 0;
      padding: 0;
      width: 100%;
      height: 100%;
      /* We'll handle scroll hiding/showing via JS. */
      font-family: Arial, sans-serif;
      color: #fff;
      background: #000;
    }

    .symbol-container {
      position: absolute;
      top: 50%;
      left: 50%;
      width: 400px;
      height: 400px;
      transform: translate(-50%, -50%);
      z-index: 1;
    }
    svg#bloodSymbol {
      width: 100%;
      height: 100%;
    }
    .rotateGroup {
      transform-box: fill-box;
      transform-origin: center;
      animation: rotatePentagram 20s linear infinite;
    }
    @keyframes rotatePentagram {
      0%   { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .blood-line {
      fill: none;
      stroke: #b00;
      stroke-width: 4;
      stroke-linejoin: round;
      stroke-linecap: round;
      filter: blur(2px);
      animation: flameFlicker 3s infinite ease-in-out;
    }
    @keyframes flameFlicker {
      0%   { stroke: #b00; opacity: 0.8; filter: blur(2px); }
      50%  { stroke: #c00; opacity: 1;   filter: blur(3px); }
      100% { stroke: #b00; opacity: 0.7; filter: blur(2px); }
    }

    /*****************************************************
     2) DRIFTING EMBERS (random sine wave)
    *****************************************************/
    .embers {
      position: absolute;
      bottom: 0; left: 0;
      width: 100%; height: 100%;
      pointer-events: none;
      z-index: 0;
    }
    .ember {
      position: absolute;
      bottom: 0;
      width: 3px; height: 3px;
      background: #c04000;
      border-radius: 50%;
      opacity: 0;
    }

    /*****************************************************
     3) TABLE WRAPPER (80% wide on large, no border, etc.)
    *****************************************************/
    .table-wrapper {
      position: relative;
      z-index: 2;
      width: 80%;
      max-width: 1200px;
      margin: 20px auto 40px auto;
      padding: 20px;
      background: rgba(0,0,0,0.4);
      border-radius: 8px;
    }

    .table-wrapper h1 {
      text-align: center;
      margin-bottom: 10px;
      color: #f00;
      text-shadow: 0 0 5px #f00;
    }

    .filters {
      text-align: center;
      margin-bottom: 10px;
    }
    .search-box {
      margin-bottom: 8px;
    }
    .search-box input {
      width: 60%;
      max-width: 300px;
      padding: 6px;
      border-radius: 4px;
      border: 1px solid #900;
      outline: none;
      background: #200;
      color: #fdd;
    }
    .evidence-boxes {
      margin-top: 5px;
    }
    .evidence-boxes label {
      margin-right: 10px;
      cursor: pointer;
    }
    .evidence-boxes input[type="checkbox"] {
      margin-right: 4px;
    }

    /*****************************************************
     4) RED TABLE (LESS RIGID)
    *****************************************************/
    .red-table {
      width: 100%;
      border-collapse: separate;
      border-spacing: 0 6px; /* row gaps */
      background: rgba(0,0,0,0.3);
    }
    .red-table th, .red-table td {
      border: none;  /* no rigid borders */
      padding: 8px 10px;
      text-align: left;
      color: #fff;
    }
    .red-table thead tr {
      background: #600; /* dark red header row */
    }
    .red-table th {
      cursor: pointer;
      text-shadow: 0 0 2px #f00;
    }
    .red-table tbody tr {
      border-radius: 6px;
    }
    .red-table tr:nth-child(even) {
      background: rgba(200,0,0,0.2); 
    }
    .red-table tr:nth-child(odd) {
      background: rgba(100,0,0,0.2);
    }
    .red-table tr:hover td {
      background: rgba(255,0,0,0.2);
    }
    .sortable::after {
      content: " \25B2\25BC";
      font-size: 0.7em;
      color: #888;
      margin-left: 5px;
    }

    /*****************************************************
     5) MOBILE-FRIENDLY 
       - Larger search boxes 
       - smaller table text
    *****************************************************/
    @media (max-width: 768px) {
      .search-box input {
        width: 90%;
        font-size: 16px;
        padding: 10px;
      }
      th, td {
        padding: 6px;
        font-size: 14px;
      }
    }
  </style>
</head>
<body>
  <!-- Spinning Pentagram in Center -->
  <div class="symbol-container">
    <svg id="bloodSymbol" viewBox="0 0 200 200">
      <g class="rotateGroup">
        <circle id="circlePath" class="blood-line" cx="100" cy="100" r="90" />
        <path id="starPath" class="blood-line"
          d="M100,10 
             L152.9,172.81 
             L14.4,72.19 
             L185.6,72.19 
             L47.1,172.81 
             Z"
        />
      </g>
    </svg>
  </div>

  <!-- Drifting Embers -->
  <div class="embers" id="emberContainer"></div>

  <!-- GHOSTS TABLE -->
  <div class="table-wrapper">
    <h1>Ghosts Table</h1>
    <div class="filters">
      <!-- Search -->
      <div class="search-box">
        <input 
          type="text" 
          id="ghostSearch" 
          placeholder="Search Ghosts..."
          onkeyup="filterAllGhosts()"
        />
      </div>
      <!-- Evidence Checkboxes -->
      <div class="evidence-boxes">
        <label>
          <input type="checkbox" value="D.O.T.S." onclick="filterAllGhosts()" />
          D.O.T.S.
        </label>
        <label>
          <input type="checkbox" value="EMF" onclick="filterAllGhosts()" />
          EMF
        </label>
        <label>
          <input type="checkbox" value="Freezing Temps" onclick="filterAllGhosts()" />
          Freezing Temps
        </label>
        <label>
          <input type="checkbox" value="Ghost Orb" onclick="filterAllGhosts()" />
          Ghost Orb
        </label>
        <label>
          <input type="checkbox" value="Ghost Writing" onclick="filterAllGhosts()" />
          Ghost Writing
        </label>
        <label>
          <input type="checkbox" value="Spirit Box" onclick="filterAllGhosts()" />
          Spirit Box
        </label>
      </div>
    </div>
    <table class="red-table" id="ghostTable">
      <thead>
        <tr>
          <th class="sortable" onclick="sortGhostTable(0,false)">Name</th>
          <th>Unique Trait</th>
          <th>Roaming Behavior</th>
          <th>Footstep Speed</th>
          <th class="sortable" onclick="sortGhostTable(4,false)">Forced Evidence</th>
          <th>Evidence</th>
          <th class="sortable" onclick="sortGhostTable(6,true)">Interaction Range</th>
          <th class="sortable" onclick="sortGhostTable(7,true)">Base Speed</th>
          <th class="sortable" onclick="sortGhostTable(8,true)">Mod. Speed</th>
          <th class="sortable" onclick="sortGhostTable(9,true)">Hunt %</th>
        </tr>
      </thead>
      <tbody>
        <!-- SPIRIT -->
<tr>
  <td>Spirit</td>
  <td>Smudge sticks last longer against it</td>
  <td>Normal</td>
  <td>Normal</td>
  <td></td>
  <td>Ghost Writing, EMF, Spirit Box</td>
  <td>1.5m / 3.0m</td>
  <td>1.6</td>
  <td>1.6</td>
  <td>50%</td>
</tr>

<!-- WRAITH -->
<tr>
  <td>Wraith</td>
  <td>No salt footsteps; can teleport to players randomly</td>
  <td>Teleport-based roam</td>
  <td>Normal</td>
  <td></td>
  <td>D.O.T.S., EMF, Spirit Box</td>
  <td>1.5m / 3.0m</td>
  <td>1.6</td>
  <td>1.6</td>
  <td>50%</td>
</tr>

<!-- PHANTOM -->
<tr>
  <td>Phantom</td>
  <td>0.5%/s sanity drain when in psuedo LOS during events; does not appear in photos</td>
  <td>Normal</td>
  <td>Normal</td>
  <td></td>
  <td>D.O.T.S., Ultraviolet, Spirit Box</td>
  <td>1.5m / 3.0m</td>
  <td>1.6</td>
  <td>1.6</td>
  <td>50%</td>
</tr>

<!-- POLTERGEIST -->
<tr>
  <td>Poltergeist</td>
  <td>Throws multiple objects at once; throw freq. is high</td>
  <td>Normal</td>
  <td>Normal</td>
  <td></td>
  <td>Ghost Writing, Ultraviolet, Spirit Box</td>
  <td>1.5m / 3.0m</td>
  <td>1.6</td>
  <td>1.6</td>
  <td>50%</td>
</tr>

<!-- BANSHEE -->
<tr>
  <td>Banshee</td>
  <td>Targets & stalks a single player; Freq. singing; hunts from range if target is inside; unique Sound on blpblpblpblp</td>
  <td>Target-focused</td>
  <td>Normal</td>
  <td></td>
  <td>D.O.T.S., Ghost Orb, Ultraviolet</td>
  <td>1.5m / 3.0m</td>
  <td>1.6</td>
  <td>1.6</td>
  <td>50%</td>
</tr>

<!-- JINN -->
<tr>
  <td>Jinn</td>
  <td>Faster if far away & breaker on; territorial near breaker and will drain sanity faster; cannot use abilities / hunt when breaker off; cannot turn off breaker (can trip by turning on too many lights)</td>
  <td>Territorial (breaker room)</td>
  <td>Normal</td>
  <td></td>
  <td>EMF, Ultraviolet, Freezing Temperatures</td>
  <td>1.5m / 3.0m</td>
  <td>1.6</td>
  <td>2.5 (up to, line-of-sight / long distance)</td>
  <td>50%</td>
</tr>

<!-- MARE -->
<tr>
  <td>Mare</td>
  <td>More likely to hunt in dark; hates lights turned on</td>
  <td>Prefers dark rooms</td>
  <td>Normal</td>
  <td></td>
  <td>Ghost Writing, Ghost Orb, Spirit Box</td>
  <td>1.5m / 3.0m</td>
  <td>1.6</td>
  <td>1.6</td>
  <td>60% / 40% (light / dark)</td>
</tr>

<!-- REVENANT -->
<tr>
  <td>Revenant</td>
  <td>Extremely fast w/ line-of-sight; very slow w/o it</td>
  <td>Normal</td>
  <td>Slow</td>
  <td></td>
  <td>Ghost Writing, Ghost Orb, Freezing Temperatures</td>
  <td>1.5m / 3.0m</td>
  <td>1.0</td>
  <td>3.0 (up to, line-of-sight)</td>
  <td>50%</td>
</tr>

<!-- SHADE -->
<tr>
  <td>Shade</td>
  <td>Very shy & quiet; fewer hunts w/ people nearby</td>
  <td>Less w/ players nearby</td>
  <td>Normal</td>
  <td></td>
  <td>Ghost Writing, EMF, Freezing Temperatures</td>
  <td>1.5m / 3.0m</td>
  <td>1.6</td>
  <td>1.6</td>
  <td>50%</td>
</tr>

<!-- DEMON -->
<tr>
  <td>Demon</td>
  <td>Frequent hunts; can hunt from 70% avg sanity; special ability hunts at 100% & larger crucifix range</td>
  <td>Aggressive</td>
  <td>Normal</td>
  <td></td>
  <td>Ghost Writing, Ultraviolet, Freezing Temperatures</td>
  <td>1.5m / 3.0m</td>
  <td>1.6</td>
  <td>1.6</td>
  <td>100% / 70% (rare ability / normal)</td>
</tr>

<!-- YUREI -->
<tr>
  <td>Yurei</td>
  <td>Can slam doors & significantly lower sanity w/ door shutting ability; confined to room after smudging</td>
  <td>Normal</td>
  <td>Normal</td>
  <td></td>
  <td>D.O.T.S., Ghost Orb, Freezing Temperatures</td>
  <td>1.5m / 3.0m</td>
  <td>1.6</td>
  <td>1.6</td>
  <td>50%</td>
</tr>

<!-- ONI -->
<tr>
  <td>Oni</td>
  <td>More visible hunts (faster blinking); highly active when people around</td>
  <td>Aggressive</td>
  <td>Normal</td>
  <td></td>
  <td>D.O.T.S., EMF, Freezing Temperatures</td>
  <td>1.5m / 3.0m</td>
  <td>1.6</td>
  <td>1.6</td>
  <td>50%</td>
</tr>

<!-- YOKAI -->
<tr>
  <td>Yokai</td>
  <td>Hunts if players talk near it (higher sanity threshold)</td>
  <td>Attracted to voices</td>
  <td>Normal</td>
  <td></td>
  <td>D.O.T.S., Ghost Orb, Spirit Box</td>
  <td>1.5m / 3.0m</td>
  <td>1.6</td>
  <td>1.6</td>
  <td>80% / 50% (talking / silent)</td>
</tr>

<!-- HANTU -->
<tr>
  <td>Hantu</td>
  <td>Moves faster in colder rooms; slower in warm; cold breath during hunts when breaker off</td>
  <td>Normal</td>
  <td>Temp-based</td>
  <td>Freezing Temperatures</td>
  <td>Ghost Orb, Ultraviolet, Freezing Temperatures</td>
  <td>1.5m / 3.0m</td>
  <td>1.4 - 2.7 (depending on room temp)</td>
  <td>1.4 - 2.7 (depending on room temp)</td>
  <td>50%</td>
</tr>

<!-- GORYO -->
<tr>
  <td>Goryo</td>
  <td>DOTS only visible on cam & while no players nearby; rarely leaves room; cannot change favorite room</td>
  <td>Minimal</td>
  <td>Normal</td>
  <td>D.O.T.S.</td>
  <td>D.O.T.S., EMF, Ultraviolet</td>
  <td>1.5m / 3.0m</td>
  <td>1.6</td>
  <td>1.6</td>
  <td>50%</td>
</tr>

<!-- MYLING -->
<tr>
  <td>Myling</td>
  <td>Quieter footsteps & more frequent vocal sounds on blpblpblpblpblp</td>
  <td>Normal</td>
  <td>Normal</td>
  <td></td>
  <td>Ghost Writing, EMF, Ultraviolet</td>
  <td>1.5m / 3.0m</td>
  <td>1.6</td>
  <td>1.6</td>
  <td>50%</td>
</tr>

<!-- ONRYO -->
<tr>
  <td>Onryo</td>
  <td>Early hunts if flame is extinguished near it</td>
  <td>Normal</td>
  <td>Normal</td>
  <td></td>
  <td>Ghost Orb, Freezing Temperatures, Spirit Box</td>
  <td>1.5m / 3.0m</td>
  <td>1.6</td>
  <td>1.6</td>
  <td>60% / 50% (flame out)</td>
</tr>

<!-- THE TWINS -->
<tr>
  <td>The Twins</td>
  <td>Two entities: main ghost & decoy w/ separate interactions</td>
  <td>Dual Roam</td>
  <td>Normal & slight variant</td>
  <td></td>
  <td>EMF, Freezing Temperatures, Spirit Box</td>
  <td>1.5m / 3.0m</td>
  <td>1.6 & 1.5</td>
  <td>1.6 & 1.7</td>
  <td>50%</td>
</tr>

<!-- RAIJU -->
<tr>
  <td>Raiju</td>
  <td>Faster near active electronics; stronger EMF interference; disrupts electronics from further away when hunting</td>
  <td>Drawn to electronics</td>
  <td>Normal</td>
  <td></td>
  <td>D.O.T.S., EMF, Ghost Orb</td>
  <td>1.5m / 3.0m</td>
  <td>1.6</td>
  <td>2.5 (up to, w/ electronics)</td>
  <td>65% / 50% (near electronics / no electronics</td>
</tr>

<!-- OBAKE -->
<tr>
  <td>Obake</td>
  <td>Fingerprints fade quickly; rare 6-finger print (16.7% chance); shapeshifts during events</td>
  <td>Normal</td>
  <td>Normal</td>
  <td>Ultraviolet</td>
  <td>EMF, Ghost Orb, Ultraviolet</td>
  <td>1.5m / 3.0m</td>
  <td>1.6</td>
  <td>1.6</td>
  <td>50%</td>
</tr>

<!-- THE MIMIC (FORCED EVIDENCE) -->
<tr>
  <td>The Mimic</td>
  <td>Copies other ghost abilities; ALWAYS has ghost orbs</td>
  <td>Varies (mimics target ghost)</td>
  <td>Varies</td>
  <td>Ghost Orbs (Still applies to no-evidence runs)</td>
  <td>Ultraviolet, Freezing Temperatures, Spirit Box</td>
  <td>1.5m / 3.0m</td>
  <td>Varies</td>
  <td>Varies</td>
  <td>Varies</td>
</tr>

<!-- MOROI -->
<tr>
  <td>Moroi</td>
  <td>Curses players via Spirit Box; speeds up as average sanity drops</td>
  <td>Normal</td>
  <td>Faster w/ lower sanity</td>
  <td>Spirit Box</td>
  <td>Ghost Writing, Freezing Temperatures, Spirit Box</td>
  <td>1.5m / 3.0m</td>
  <td>1.5 (at max sanity)</td>
  <td>2.25 (up to, at 0% sanity</td>
  <td>50%</td>
</tr>

<!-- DEOGEN -->
<tr>
  <td>Deogen</td>
  <td>Knows your location always; very slow up close, faster far</td>
  <td>Pinpoint</td>
  <td>Variable</td>
  <td>Spirit Box</td>
  <td>D.O.T.S., Ghost Writing, Spirit</td>
  <td>1.5m / 3.0m</td>
  <td>1.6 (avg)</td>
  <td>3.0 - 0.4 (distance-based)</td>
  <td>40%</td>
</tr>

<!-- THAYE -->
<tr>
  <td>Thaye</td>
  <td>Starts very active & fast; ages/weaker the longer players are nearby to it</td>
  <td>Normal & Early</td>
  <td>Decreases over time</td>
  <td></td>
  <td>D.O.T.S., Ghost Writing, Ghost Orb</td>
  <td>1.5m / 3.0m</td>
  <td>1.6 (initial)</td>
  <td>1.0 (final ()</td>
  <td>75% / 15% (declines over time)</td>
</tr>

      </tbody>
    </table>
  </div>

  <!-- CURSED ITEMS TABLE -->
  <div class="table-wrapper">
    <h1>Cursed Items Table</h1>
    <div class="search-box" style="text-align:center;">
      <input 
        type="text"
        id="cursedSearch"
        placeholder="Search Cursed Items..."
        onkeyup="searchSimple('cursedSearch','cursedTable')"
      />
    </div>
    <table class="red-table" id="cursedTable">
      <thead>
        <tr>
          <th>Map</th>
          <th>Ouija Board</th>
          <th>Music Box</th>
          <th>Tarot Cards</th>
          <th>Summoning Circle</th>
          <th>Haunted Mirror</th>
          <th>Voodoo Doll</th>
          <th>Monkey Paw</th>
        </tr>
      </thead>
      <tbody>
        <!-- TANGLEWOOD (provided example) -->
<tr>
  <td>6 Tanglewood Drive</td>
  <td>Basement table</td>
  <td>Nursery shelf</td>
  <td>Living Room end table</td>
  <td>Basement center</td>
  <td>Master BR wall</td>
  <td>Garage trashcan</td>
  <td>Living Room case</td>
</tr>

<!-- EDGEFIELD -->
<tr>
  <td>42 Edgefield Road</td>
  <td>Basement storage (under stairs)</td>
  <td>1F living room side table</td>
  <td>Dining room table</td>
  <td>Basement center</td>
  <td>2F hallway wall</td>
  <td>Master BR corner floor</td>
  <td>2F hallway table</td>
</tr>

<!-- RIDGEVIEW -->
<tr>
  <td>10 Ridgeview Court</td>
  <td>Basement shelf near stairs</td>
  <td>1F living room coffee table</td>
  <td>Kitchen island</td>
  <td>Basement center</td>
  <td>Master BR closet wall</td>
  <td>Upstairs hallway corner</td>
  <td>1F office desk</td>
</tr>

<!-- WILLOW -->
<tr>
  <td>13 Willow Street</td>
  <td>Basement shelf (hallway)</td>
  <td>Living room TV stand</td>
  <td>Living room coffee table</td>
  <td>Basement corner</td>
  <td>Garage wall hook</td>
  <td>Blue bedroom closet floor</td>
  <td>Garage shelf near door</td>
</tr>

<!-- GRAFTON -->
<tr>
  <td>Grafton Farmhouse</td>
  <td>Utility side room (1F)</td>
  <td>Living room small table</td>
  <td>Dining table (main room)</td>
  <td>2F storage (center)</td>
  <td>Upstairs hallway wall</td>
  <td>Nursery rocking chair</td>
  <td>Bench near front door</td>
</tr>

<!-- BLEASDALE -->
<tr>
  <td>Bleasdale Farmhouse</td>
  <td>1F workshop shelf</td>
  <td>Living room bookshelf</td>
  <td>Main hallway table</td>
  <td>Attic center</td>
  <td>2F hallway wall</td>
  <td>1F storage closet floor</td>
  <td>2F bedroom closet</td>
</tr>

<!-- BROWNSTONE HIGH SCHOOL -->
<tr>
  <td>Brownstone High School</td>
  <td>Main foyer bench</td>
  <td>Entrance hallway table</td>
  <td>Cafeteria table (left side)</td>
  <td>Courtyard center</td>
  <td>Principal’s office wall</td>
  <td>Left wing hallway locker</td>
  <td>Right wing hallway locker</td>
</tr>

<!-- PRISON -->
<tr>
  <td>Prison</td>
  <td>Visitation area bench</td>
  <td>Warden’s office desk</td>
  <td>Cafeteria dining table</td>
  <td>Outside yard center</td>
  <td>Warden’s office wall</td>
  <td>Block A table</td>
  <td>Block B shelf</td>
</tr>

<!-- MAPLE LODGE CAMPSITE -->
<tr>
  <td>Maple Lodge Campsite</td>
  <td>Lobby building front counter</td>
  <td>Lodge lounge table (downstairs)</td>
  <td>Campfire bench</td>
  <td>Central camp path</td>
  <td>Lodge bathroom wall</td>
  <td>Lodge 2F bedroom floor</td>
  <td>Lodge 1F side shelf</td>
</tr>

<!-- CAMP WOODWIND -->
<tr>
  <td>Camp Woodwind</td>
  <td>Picnic table near tents</td>
  <td>Folding table by entrance</td>
  <td>Foldable table near fire pit</td>
  <td>Center by campfire</td>
  <td>Behind green tent (on wall)</td>
  <td>White tent corner</td>
  <td>Cornhole game area shelf</td>
</tr>

<!-- SUNNY MEADOWS (Asylum) -->
<tr>
  <td>Sunny Meadows</td>
  <td>Lobby reception desk</td>
  <td>Chapel altar table</td>
  <td>Main lobby table</td>
  <td>Courtyard center</td>
  <td>Hall near Morgue door</td>
  <td>East Wing patient room</td>
  <td>Chapel front pew bench</td>
</tr>

<!-- SUNNY MEADOWS RESTRICTED -->
<tr>
  <td>Sunny Meadows (Restricted)</td>
  <td>Random wing reception desk</td>
  <td>Chapel side shelf</td>
  <td>Hallway side table</td>
  <td>One accessible wing’s center</td>
  <td>Wing corridor wall</td>
  <td>Side patient room bed</td>
  <td>Hall bench (accessible area)</td>
</tr>

      </tbody>
    </table>
  </div>

<script>
  /************************************************************
   1) DRAW THE CIRCLE THEN THE PENTAGRAM
  ************************************************************/
  const circlePath = document.getElementById("circlePath");
  const starPath   = document.getElementById("starPath");

  const circleLen = circlePath.getTotalLength();
  const starLen   = starPath.getTotalLength();

  circlePath.style.strokeDasharray  = circleLen;
  circlePath.style.strokeDashoffset = circleLen;
  starPath.style.strokeDasharray    = starLen;
  starPath.style.strokeDashoffset   = starLen;

  drawPath(circlePath, circleLen, 2000, () => {
    drawPath(starPath, starLen, 3000);
  });

  function drawPath(pathElem, totalLen, duration, onComplete) {
    let start = null;
    function step(timestamp) {
      if (!start) start = timestamp;
      let progress = timestamp - start;
      let fraction = Math.min(progress / duration, 1);
      pathElem.style.strokeDashoffset = totalLen * (1 - fraction);
      if (fraction < 1) {
        requestAnimationFrame(step);
      } else if (onComplete) {
        onComplete();
      }
    }
    requestAnimationFrame(step);
  }

  /************************************************************
   2) EMBERS (Random Sine-Wave Drift)
  ************************************************************/
  const emberContainer = document.getElementById("emberContainer");
  let emberIndex = 0;

  function spawnEmber() {
    emberIndex++;
    const ember = document.createElement('div');
    ember.classList.add('ember');
    ember.style.left = (Math.random() * 100) + '%';

    const maxRise = 300 + Math.random() * 400;
    const waveCount = 0.5 + Math.random() * 1.5;
    const amplitude = 5 + Math.random() * 10;
    const sign      = Math.random() < 0.5 ? 1 : -1;

    const animName = 'emberFloat' + emberIndex;
    const styleEl  = document.createElement('style');

    let keyframes = `@keyframes ${animName} {\n`;
    for (let i=0; i<=100; i+=5) {
      const frac = i/100;
      const x = amplitude * sign * Math.sin(waveCount * 2*Math.PI * frac);
      const y = -maxRise * frac;
      let op = 1;
      if (i <= 10)      op = i/10;
      else if (i >= 90) op = 1 - (i-90)/10;

      keyframes += `
        ${i}% {
          transform: translate(${x}px, ${y}px);
          opacity: ${op.toFixed(2)};
        }
      `;
    }
    keyframes += '}';

    styleEl.innerHTML = keyframes;
    document.head.appendChild(styleEl);

    ember.style.animation = `${animName} 5.5s linear forwards`;
    ember.addEventListener('animationend', () => {
      if (ember.parentNode) ember.parentNode.removeChild(ember);
      document.head.removeChild(styleEl);
    });

    emberContainer.appendChild(ember);
  }

  // spawn embers
  setInterval(spawnEmber, 700);
  for (let i=0; i<12; i++) spawnEmber();

  /************************************************************
   3) GHOSTS TABLE: SEARCH + EVIDENCE FILTER
  ************************************************************/
function filterAllGhosts() {
  const searchInput = document.getElementById("ghostSearch").value.toLowerCase();
  const table = document.getElementById("ghostTable");
  const tbody = table.getElementsByTagName("tbody")[0];
  const rows = tbody.getElementsByTagName("tr");

  // Collect the user-checked evidence from checkboxes
  const checkboxes = document.querySelectorAll(".evidence-boxes input[type='checkbox']");
  let selectedEvidences = [];
  checkboxes.forEach(cb => {
    if (cb.checked) {
      selectedEvidences.push(cb.value.toLowerCase());
    }
  });

  for (let i = 0; i < rows.length; i++) {
    // Start by showing the row; we’ll hide it if it fails any test
    rows[i].style.display = "";

    // 1) Filter by text search
    const rowText = rows[i].textContent.toLowerCase();
    if (searchInput && !rowText.includes(searchInput)) {
      rows[i].style.display = "none";
      continue; // move to next row
    }

    // 2) Filter by evidence
    //    col 4 = forced evidence, col 5 = normal evidence
    const forcedEvidence = rows[i].getElementsByTagName("td")[4].textContent.toLowerCase();
    const allEvidence    = rows[i].getElementsByTagName("td")[5].textContent.toLowerCase();

    // For each user-checked evidence, confirm it’s in EITHER forced or normal
    for (let ev of selectedEvidences) {
      if (!forcedEvidence.includes(ev) && !allEvidence.includes(ev)) {
        // This means the row does NOT have the needed evidence in forced or normal
        rows[i].style.display = "none";
        break; // no need to check more evidences for this row
      }
    }
  }
}


  /************************************************************
   4) SORTING FOR GHOST TABLE
  ************************************************************/
  function sortGhostTable(colIndex, numeric) {
    const table = document.getElementById("ghostTable");
    const tbody = table.getElementsByTagName("tbody")[0];
    let rows = Array.from(tbody.getElementsByTagName("tr"));

    const currentDir = table.getAttribute("data-sortdir"+colIndex) || "asc";
    const newDir = (currentDir === "asc") ? "desc" : "asc";
    table.setAttribute("data-sortdir"+colIndex, newDir);

    rows.sort((a,b) => {
      let x = a.getElementsByTagName("td")[colIndex].textContent.trim();
      let y = b.getElementsByTagName("td")[colIndex].textContent.trim();

      if (numeric) {
        x = parseFloat(x.replace(/[^\d.]/g, "")) || 0;
        y = parseFloat(y.replace(/[^\d.]/g, "")) || 0;
      } else {
        x = x.toLowerCase();
        y = y.toLowerCase();
      }

      if (newDir === "asc") {
        return (x > y) ? 1 : (x < y) ? -1 : 0;
      } else {
        return (x < y) ? 1 : (x > y) ? -1 : 0;
      }
    });
    rows.forEach(r => tbody.appendChild(r));
  }

  /************************************************************
   5) SIMPLE SEARCH FOR CURSED ITEMS
  ************************************************************/
  function searchSimple(inputId, tableId) {
    const input = document.getElementById(inputId).value.toLowerCase();
    const table = document.getElementById(tableId);
    const rows = table.getElementsByTagName("tr");

    for (let i=1; i<rows.length; i++) {
      const rowText = rows[i].textContent.toLowerCase();
      rows[i].style.display = rowText.includes(input) ? "" : "none";
    }
  }

  /************************************************************
   6) DEFAULT SORT BY NAME (DESC from A to Z top->bottom) ON LOAD
  ************************************************************/
  window.addEventListener('load', () => {
    // We'll interpret "descending so from A at top to Z at bottom" 
    // as standard alphabetical ascending. 
    // We'll do a trick to ensure we end up w/ 'desc' from the code's viewpoint
    // so the final visual is A->Z top to bottom.
    const ghostTable = document.getElementById('ghostTable');
    // Force next toggle on col 0 to be asc
    ghostTable.setAttribute('data-sortdir0','desc'); 
    // Now calling sort triggers newDir = 'asc' => "A to Z" top->bottom
    sortGhostTable(0,false);

    checkScroll();
  });

  /************************************************************
   7) SHOW/HIDE SCROLLBAR ON DESKTOP IF CONTENT FITS
      On mobile, always enable scroll
  ************************************************************/
  window.addEventListener('resize', checkScroll);
  function checkScroll() {
    // if mobile, always show auto
    if (window.innerWidth <= 768) {
      document.body.style.overflowY = 'auto';
      return;
    }
    // desktop
    if (document.body.scrollHeight > window.innerHeight) {
      document.body.style.overflowY = 'auto';  // content > screen => scroll
    } else {
      document.body.style.overflowY = 'hidden'; // content fits => hide scrollbar
    }
  }
</script>
</body>
</html>
