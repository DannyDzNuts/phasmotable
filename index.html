<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Standard mobile-friendly viewport (no orientation lock) -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
  <meta charset="UTF-8" />
  <title>Spinning Pentagram + Softer Red Tables (Final)</title>
  <style>
    /*****************************************************
     1) DEMONIC BACKGROUND (Spinning Circle + Pentagram)
    *****************************************************/
    html, body {
      margin: 0;
      padding: 0;
      width: 100%;
      height: 100%;
      /* Removed overflow: hidden; so scrollbars can appear if needed */
      font-family: Arial, sans-serif;
      color: #fff;
      background: #000; 
    }

    .symbol-container {
      position: absolute;
      top: 50%;
      left: 50%;
      width: 400px;
      height: 400px;
      transform: translate(-50%, -50%);
      z-index: 1;
    }
    svg#bloodSymbol {
      width: 100%;
      height: 100%;
    }
    .rotateGroup {
      transform-box: fill-box;
      transform-origin: center;
      animation: rotatePentagram 20s linear infinite;
    }
    @keyframes rotatePentagram {
      0%   { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .blood-line {
      fill: none;
      stroke: #b00;
      stroke-width: 4;
      stroke-linejoin: round;
      stroke-linecap: round;
      filter: blur(2px);
      animation: flameFlicker 3s infinite ease-in-out;
    }
    @keyframes flameFlicker {
      0%   { stroke: #b00; opacity: 0.8; filter: blur(2px); }
      50%  { stroke: #c00; opacity: 1;   filter: blur(3px); }
      100% { stroke: #b00; opacity: 0.7; filter: blur(2px); }
    }

    /*****************************************************
     2) DRIFTING EMBERS (Random Sine Wave)
    *****************************************************/
    .embers {
      position: absolute;
      bottom: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 0;
    }
    .ember {
      position: absolute;
      bottom: 0;
      width: 3px; 
      height: 3px;
      background: #c04000;
      border-radius: 50%;
      opacity: 0;
    }

    /*****************************************************
     3) TABLE WRAPPER
       - 80% wide, up to 1200px, no extra border
    *****************************************************/
    .table-wrapper {
      position: relative;
      z-index: 2;
      width: 80%;
      max-width: 1200px;
      margin: 20px auto;
      padding: 20px;
      background: rgba(0,0,0,0.4);
      border-radius: 8px;
      margin-bottom: 40px;
    }

    .table-wrapper h1 {
      text-align: center;
      margin-bottom: 10px;
      color: #f00;
      text-shadow: 0 0 5px #f00;
    }
    .filters {
      text-align: center;
      margin-bottom: 10px;
    }
    .search-box {
      margin-bottom: 8px;
    }
    .search-box input {
      width: 60%;
      max-width: 300px;
      padding: 6px;
      border-radius: 4px;
      border: 1px solid #900;
      outline: none;
      background: #200;
      color: #fdd;
    }
    .evidence-boxes {
      margin-top: 5px;
    }
    .evidence-boxes label {
      margin-right: 10px;
      cursor: pointer;
    }
    .evidence-boxes input[type="checkbox"] {
      margin-right: 4px;
    }

    /*****************************************************
     4) RED TABLE (LESS RIGID)
    *****************************************************/
    .red-table {
      width: 100%;
      border-collapse: separate;
      border-spacing: 0 6px;
      background: rgba(0,0,0,0.3);
    }
    .red-table th, .red-table td {
      border: none;
      padding: 8px 10px;
      text-align: left;
      color: #fff;
    }
    .red-table thead tr {
      background: #600; /* dark red */
    }
    .red-table th {
      cursor: pointer;
      text-shadow: 0 0 2px #f00;
    }
    .red-table tbody tr {
      border-radius: 6px;
    }
    .red-table tr:nth-child(even) {
      background: rgba(200,0,0,0.2); 
    }
    .red-table tr:nth-child(odd) {
      background: rgba(100,0,0,0.2);
    }
    .red-table tr:hover td {
      background: rgba(255,0,0,0.2);
    }
    .sortable::after {
      content: " \25B2\25BC";
      font-size: 0.7em;
      color: #888;
      margin-left: 5px;
    }

    /*****************************************************
     5) MOBILE-FRIENDLY 
       - Larger search boxes (font + padding) 
       - smaller table text
    *****************************************************/
    @media (max-width: 768px) {
      .search-box input {
        width: 90%;
        font-size: 16px;  /* bigger for readability */
        padding: 10px; 
      }
      th, td {
        padding: 6px;
        font-size: 14px;
      }
    }
  </style>
</head>
<body>

  <!-- Spinning Pentagram -->
  <div class="symbol-container">
    <svg id="bloodSymbol" viewBox="0 0 200 200">
      <g class="rotateGroup">
        <!-- Circle drawn first -->
        <circle
          id="circlePath"
          class="blood-line"
          cx="100"
          cy="100"
          r="90"
        />
        <!-- Pentagram drawn second -->
        <path
          id="starPath"
          class="blood-line"
          d="M100,10 
             L152.9,172.81 
             L14.4,72.19 
             L185.6,72.19 
             L47.1,172.81 
             Z"
        />
      </g>
    </svg>
  </div>

  <!-- Embers -->
  <div class="embers" id="emberContainer"></div>

  <!-- Ghosts Table -->
  <div class="table-wrapper">
    <h1>Ghosts Table</h1>
    <div class="filters">
      <div class="search-box">
        <input 
          type="text" 
          id="ghostSearch" 
          placeholder="Search Ghosts..."
          onkeyup="filterAllGhosts()"
        />
      </div>
      <div class="evidence-boxes">
        <label>
          <input type="checkbox" value="Spirit Box" onclick="filterAllGhosts()" />
          Spirit Box
        </label>
        <label>
          <input type="checkbox" value="Ghost Orbs" onclick="filterAllGhosts()" />
          Ghost Orbs
        </label>
        <label>
          <input type="checkbox" value="Freezing Temps" onclick="filterAllGhosts()" />
          Freezing Temps
        </label>
      </div>
    </div>
    <table class="red-table" id="ghostTable">
      <thead>
        <tr>
          <!-- 0: Name (text, sortable) -->
          <th class="sortable" onclick="sortGhostTable(0,false)">Name</th>
          <!-- 1: Unique Trait (text, not sorted) -->
          <th>Unique Trait</th>
          <!-- 2: Roaming Behavior -->
          <th>Roaming Behavior</th>
          <!-- 3: Footstep Speed -->
          <th>Footstep Speed</th>
          <!-- 4: Forced Evidence (text, sortable) -->
          <th class="sortable" onclick="sortGhostTable(4,false)">Forced Evidence</th>
          <!-- 5: Interaction Range (numeric) -->
          <th class="sortable" onclick="sortGhostTable(5,true)">Interaction Range</th>
          <!-- 6: Base Speed (numeric) -->
          <th class="sortable" onclick="sortGhostTable(6,true)">Base Speed</th>
          <!-- 7: Speed w/ Modifier (numeric) -->
          <th class="sortable" onclick="sortGhostTable(7,true)">Mod. Speed</th>
          <!-- 8: Hunt Threshold (numeric) -->
          <th class="sortable" onclick="sortGhostTable(8,true)">Hunt %</th>
        </tr>
      </thead>
      <tbody>
        <!-- Example data with new columns -->
        <tr>
          <td>Revenant</td>
          <td>Extremely fast w/LOS, slow w/o</td>
          <td>Average roam</td>
          <td>Fast w/LOS; slow w/o</td>
          <td></td>
          <td>12m</td>
          <td>1.6</td>
          <td>5.0</td>
          <td>50%</td>
        </tr>
        <tr>
          <td>Demon</td>
          <td>Can hunt at higher sanity</td>
          <td>Aggressive roam</td>
          <td>Normal</td>
          <td>Freezing Temps</td>
          <td>10m</td>
          <td>1.6</td>
          <td>1.6</td>
          <td>70%</td>
        </tr>
        <tr>
          <td>The Mimic</td>
          <td>Copies other ghosts</td>
          <td>Unpredictable roam</td>
          <td>Mimics speeds</td>
          <td>Ghost Orbs</td>
          <td>10m</td>
          <td>1.6</td>
          <td>2.5</td>
          <td>50%</td>
        </tr>
        <tr>
          <td>Deogen</td>
          <td>Always knows your location; slow near target</td>
          <td>Rarely roams far</td>
          <td>Fast far; slow close</td>
          <td>Spirit Box</td>
          <td>20m</td>
          <td>1.6</td>
          <td>3.5</td>
          <td>40%</td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Cursed Items Table -->
  <div class="table-wrapper">
    <h1>Cursed Items Table</h1>
    <div class="search-box" style="text-align:center;">
      <input 
        type="text"
        id="cursedSearch"
        placeholder="Search Cursed Items..."
        onkeyup="searchSimple('cursedSearch','cursedTable')"
      />
    </div>
    <table class="red-table" id="cursedTable">
      <thead>
        <tr>
          <th>Map</th>
          <th>Ouija Board</th>
          <th>Music Box</th>
          <th>Tarot Cards</th>
          <th>Summoning Circle</th>
          <th>Haunted Mirror</th>
          <th>Voodoo Doll</th>
          <th>Monkey Paw</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>6 Tanglewood Drive</td>
          <td>Basement table</td>
          <td>Nursery shelf</td>
          <td>Living Room end table</td>
          <td>Basement center</td>
          <td>Master BR wall</td>
          <td>Garage trashcan</td>
          <td>Living Room case</td>
        </tr>
      </tbody>
    </table>
  </div>

<script>
  /************************************************************
   1) DRAW THE CIRCLE, THEN THE PENTAGRAM
  ************************************************************/
  const circlePath = document.getElementById("circlePath");
  const starPath   = document.getElementById("starPath");

  const circleLen = circlePath.getTotalLength();
  const starLen   = starPath.getTotalLength();

  circlePath.style.strokeDasharray  = circleLen;
  circlePath.style.strokeDashoffset = circleLen;
  starPath.style.strokeDasharray    = starLen;
  starPath.style.strokeDashoffset   = starLen;

  drawPath(circlePath, circleLen, 2000, () => {
    drawPath(starPath, starLen, 3000);
  });

  function drawPath(pathElem, totalLen, duration, onComplete) {
    let start = null;
    function step(timestamp) {
      if (!start) start = timestamp;
      let progress = timestamp - start;
      let fraction = Math.min(progress / duration, 1);
      pathElem.style.strokeDashoffset = totalLen * (1 - fraction);
      if (fraction < 1) {
        requestAnimationFrame(step);
      } else if (onComplete) {
        onComplete();
      }
    }
    requestAnimationFrame(step);
  }

  /************************************************************
   2) EMBERS (Random Sine-Wave Drift)
  ************************************************************/
  const emberContainer = document.getElementById("emberContainer");
  let emberIndex = 0;

  function spawnEmber() {
    emberIndex++;
    const ember = document.createElement('div');
    ember.classList.add('ember');
    ember.style.left = (Math.random() * 100) + '%';

    const maxRise = 300 + Math.random() * 400;
    const waveCount = 0.5 + Math.random() * 1.5;
    const amplitude = 5 + Math.random() * 10;
    const sign      = Math.random() < 0.5 ? 1 : -1;

    const animName = 'emberFloat' + emberIndex;
    const styleEl  = document.createElement('style');

    let keyframes = `@keyframes ${animName} {\n`;
    for (let i=0; i<=100; i+=5) {
      const frac = i/100;
      const x = amplitude * sign * Math.sin(waveCount * 2*Math.PI * frac);
      const y = -maxRise * frac;
      let op = 1;
      if (i <= 10)      op = i/10;
      else if (i >= 90) op = 1 - (i-90)/10;

      keyframes += `
        ${i}% {
          transform: translate(${x}px, ${y}px);
          opacity: ${op.toFixed(2)};
        }
      `;
    }
    keyframes += '}';

    styleEl.innerHTML = keyframes;
    document.head.appendChild(styleEl);

    ember.style.animation = `${animName} 5.5s linear forwards`;
    ember.addEventListener('animationend', () => {
      if (ember.parentNode) ember.parentNode.removeChild(ember);
      document.head.removeChild(styleEl);
    });

    emberContainer.appendChild(ember);
  }

  setInterval(spawnEmber, 700);
  for (let i=0; i<12; i++) spawnEmber();

  /************************************************************
   3) GHOSTS TABLE: SEARCH + EVIDENCE FILTER
  ************************************************************/
  function filterAllGhosts() {
    const searchInput = document.getElementById("ghostSearch").value.toLowerCase();
    const table = document.getElementById("ghostTable");
    const tbody = table.getElementsByTagName("tbody")[0];
    const rows = tbody.getElementsByTagName("tr");

    // gather selected evidences
    const checkboxes = document.querySelectorAll(".evidence-boxes input[type='checkbox']");
    let selectedEvidences = [];
    checkboxes.forEach(cb => {
      if (cb.checked) {
        selectedEvidences.push(cb.value.toLowerCase());
      }
    });

    for (let i=0; i<rows.length; i++) {
      rows[i].style.display = "";

      // text search
      const rowText = rows[i].textContent.toLowerCase();
      if (searchInput && !rowText.includes(searchInput)) {
        rows[i].style.display = "none";
        continue;
      }

      // forced evidence col index=4
      const forcedEvidence = rows[i].getElementsByTagName("td")[4].textContent.toLowerCase();
      for (let ev of selectedEvidences) {
        if (!forcedEvidence.includes(ev)) {
          rows[i].style.display = "none";
          break;
        }
      }
    }
  }

  /************************************************************
   4) SORTING FOR GHOST TABLE
  ************************************************************/
  // colIndex: which column to sort by
  // numeric: whether to parse numeric
  function sortGhostTable(colIndex, numeric) {
    const table = document.getElementById("ghostTable");
    const tbody = table.getElementsByTagName("tbody")[0];
    let rows = Array.from(tbody.getElementsByTagName("tr"));

    // track current direction for that column
    const currentDir = table.getAttribute("data-sortdir"+colIndex) || "asc";
    const newDir = (currentDir === "asc") ? "desc" : "asc";
    table.setAttribute("data-sortdir"+colIndex, newDir);

    rows.sort((a,b) => {
      let x = a.getElementsByTagName("td")[colIndex].textContent.trim();
      let y = b.getElementsByTagName("td")[colIndex].textContent.trim();

      if (numeric) {
        // parse out 'm', '%' etc.
        x = parseFloat(x.replace(/[^\d.]/g, "")) || 0;
        y = parseFloat(y.replace(/[^\d.]/g, "")) || 0;
      } else {
        x = x.toLowerCase();
        y = y.toLowerCase();
      }

      if (newDir === "asc") {
        return (x > y) ? 1 : (x < y) ? -1 : 0;
      } else {
        return (x < y) ? 1 : (x > y) ? -1 : 0;
      }
    });
    rows.forEach(r => tbody.appendChild(r));
  }

  /************************************************************
   5) SIMPLE SEARCH FOR CURSED ITEMS TABLE
  ************************************************************/
  function searchSimple(inputId, tableId) {
    const input = document.getElementById(inputId).value.toLowerCase();
    const table = document.getElementById(tableId);
    const rows = table.getElementsByTagName("tr");

    for (let i=1; i<rows.length; i++) {
      const rowText = rows[i].textContent.toLowerCase();
      rows[i].style.display = rowText.includes(input) ? "" : "none";
    }
  }

  /************************************************************
   6) DEFAULT SORT BY NAME (DESC) ON PAGE LOAD
  ************************************************************/
  window.addEventListener('load', () => {
    // Force the next toggle on col 0 to be desc
    const ghostTable = document.getElementById('ghostTable');
    ghostTable.setAttribute('data-sortdir0', 'asc'); 
    // Then call sort => toggles to desc
    sortGhostTable(0,false);
  });
</script>
</body>
</html>
